[2026-01-15T18:19:09.013+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ml_process_from_drift_to_ab.retrain_and_register manual__2026-01-15T18:18:35.540470+00:00 [queued]>
[2026-01-15T18:19:09.023+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ml_process_from_drift_to_ab.retrain_and_register manual__2026-01-15T18:18:35.540470+00:00 [queued]>
[2026-01-15T18:19:09.024+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2026-01-15T18:19:09.043+0000] {taskinstance.py:2217} INFO - Executing <Task(_PythonDecoratedOperator): retrain_and_register> on 2026-01-15 18:18:35.540470+00:00
[2026-01-15T18:19:09.058+0000] {standard_task_runner.py:60} INFO - Started process 3915 to run task
[2026-01-15T18:19:09.075+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'ml_process_from_drift_to_ab', 'retrain_and_register', 'manual__2026-01-15T18:18:35.540470+00:00', '--job-id', '22', '--raw', '--subdir', 'DAGS_FOLDER/ml_pipeline_dag.py', '--cfg-path', '/tmp/tmpwcgsqro2']
[2026-01-15T18:19:09.082+0000] {standard_task_runner.py:88} INFO - Job 22: Subtask retrain_and_register
[2026-01-15T18:19:09.175+0000] {task_command.py:423} INFO - Running <TaskInstance: ml_process_from_drift_to_ab.retrain_and_register manual__2026-01-15T18:18:35.540470+00:00 [running]> on host 9d2f2e43e259
[2026-01-15T18:19:09.268+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='ml_process_from_drift_to_ab' AIRFLOW_CTX_TASK_ID='retrain_and_register' AIRFLOW_CTX_EXECUTION_DATE='2026-01-15T18:18:35.540470+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2026-01-15T18:18:35.540470+00:00'
[2026-01-15T18:19:10.721+0000] {logging_mixin.py:188} WARNING - 2026/01/15 18:19:10 WARNING mlflow.utils.git_utils: Failed to import Git (the Git executable is probably not on your PATH), so Git SHA is not available. Error: Failed to initialize: Bad git executable.
The git executable must be specified in one of the following ways:
    - be included in your $PATH
    - be set via $GIT_PYTHON_GIT_EXECUTABLE
    - explicitly set via git.refresh(<full-path-to-git-executable>)

All git commands will error until this is rectified.

This initial message can be silenced or aggravated in the future by setting the
$GIT_PYTHON_REFRESH environment variable. Use one of the following values:
    - quiet|q|silence|s|silent|none|n|0: for no message or exception
    - warn|w|warning|log|l|1: for a warning message (logging level CRITICAL, displayed by default)
    - error|e|exception|raise|r|2: for a raised exception

Example:
    export GIT_PYTHON_REFRESH=quiet
[2026-01-15T18:19:14.139+0000] {logging_mixin.py:188} WARNING - Processing:   0%|          | 0/61 [00:00<?, ?it/s]
[2026-01-15T18:19:21.138+0000] {logging_mixin.py:188} WARNING - Processing:   8%|8         | 5/61 [00:06<01:18,  1.40s/it]
[2026-01-15T18:19:21.376+0000] {logging_mixin.py:188} WARNING - Processing:  11%|#1        | 7/61 [00:07<00:50,  1.07it/s]
[2026-01-15T18:19:27.233+0000] {logging_mixin.py:188} WARNING - Processing:  15%|#4        | 9/61 [00:13<01:24,  1.62s/it]
[2026-01-15T18:19:27.542+0000] {logging_mixin.py:188} WARNING - Processing:  18%|#8        | 11/61 [00:13<00:56,  1.14s/it]
[2026-01-15T18:19:27.768+0000] {logging_mixin.py:188} WARNING - Processing:  25%|##4       | 15/61 [00:13<00:28,  1.63it/s]
[2026-01-15T18:19:27.992+0000] {logging_mixin.py:188} WARNING - Processing:  31%|###1      | 19/61 [00:13<00:16,  2.59it/s]
[2026-01-15T18:19:44.074+0000] {logging_mixin.py:188} WARNING - Processing:  34%|###4      | 21/61 [00:29<01:24,  2.12s/it]
[2026-01-15T18:19:34.212+0000] {job.py:213} ERROR - Job heartbeat got an exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/jobs/job.py", line 187, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/api_internal/internal_api_call.py", line 114, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/jobs/job.py", line 308, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1717, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) database is locked
[SQL: SELECT job.id AS job_id, job.dag_id AS job_dag_id, job.state AS job_state, job.job_type AS job_job_type, job.start_date AS job_start_date, job.end_date AS job_end_date, job.latest_heartbeat AS job_latest_heartbeat, job.executor_class AS job_executor_class, job.hostname AS job_hostname, job.unixname AS job_unixname 
FROM job 
WHERE job.id = ?]
[parameters: (22,)]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2026-01-15T18:19:44.108+0000] {job.py:221} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2026-01-15T18:19:44.225+0000] {logging_mixin.py:188} WARNING - Processing:  38%|###7      | 23/61 [00:30<01:01,  1.62s/it]
[2026-01-15T18:19:44.345+0000] {logging_mixin.py:188} WARNING - Processing:  41%|####      | 25/61 [00:30<00:43,  1.22s/it]
[2026-01-15T18:19:44.607+0000] {logging_mixin.py:188} WARNING - Processing:  44%|####4     | 27/61 [00:30<00:31,  1.09it/s]
[2026-01-15T18:19:45.253+0000] {logging_mixin.py:188} WARNING - Processing:  48%|####7     | 29/61 [00:31<00:24,  1.32it/s]
[2026-01-15T18:19:45.410+0000] {logging_mixin.py:188} WARNING - Processing:  51%|#####     | 31/61 [00:31<00:16,  1.77it/s]
[2026-01-15T18:19:45.615+0000] {logging_mixin.py:188} WARNING - Processing:  57%|#####7    | 35/61 [00:31<00:08,  2.99it/s]
[2026-01-15T18:19:45.760+0000] {logging_mixin.py:188} WARNING - Processing:  61%|######    | 37/61 [00:31<00:06,  3.70it/s]
[2026-01-15T18:19:45.901+0000] {logging_mixin.py:188} WARNING - Processing:  64%|######3   | 39/61 [00:31<00:04,  4.57it/s]
[2026-01-15T18:19:46.183+0000] {logging_mixin.py:188} WARNING - Processing:  67%|######7   | 41/61 [00:32<00:03,  5.05it/s]
[2026-01-15T18:19:46.320+0000] {logging_mixin.py:188} WARNING - Processing:  70%|#######   | 43/61 [00:32<00:02,  6.17it/s]
[2026-01-15T18:19:46.507+0000] {logging_mixin.py:188} WARNING - Processing:  77%|#######7  | 47/61 [00:32<00:01,  9.00it/s]
[2026-01-15T18:19:46.810+0000] {logging_mixin.py:188} WARNING - Processing:  80%|########  | 49/61 [00:32<00:01,  8.27it/s]
[2026-01-15T18:19:46.947+0000] {logging_mixin.py:188} WARNING - Processing:  84%|########3 | 51/61 [00:32<00:01,  9.30it/s]
[2026-01-15T18:19:47.799+0000] {logging_mixin.py:188} WARNING - Processing:  87%|########6 | 53/61 [00:33<00:01,  5.19it/s]
[2026-01-15T18:19:47.942+0000] {logging_mixin.py:188} WARNING - Processing:  90%|######### | 55/61 [00:33<00:00,  6.29it/s]
[2026-01-15T18:19:48.119+0000] {logging_mixin.py:188} WARNING - Processing:  97%|#########6| 59/61 [00:33<00:00,  9.22it/s]
[2026-01-15T18:19:48.262+0000] {logging_mixin.py:188} WARNING - Processing: 100%|##########| 61/61 [00:34<00:00, 10.04it/s]
[2026-01-15T18:19:48.262+0000] {logging_mixin.py:188} WARNING -                                                            
[2026-01-15T18:20:37.885+0000] {logging_mixin.py:188} INFO -                                     Model  Accuracy     AUC  Recall   Prec.  \
lda          Linear Discriminant Analysis    1.0000  0.0000  1.0000  1.0000   
lr                    Logistic Regression    0.9444  0.0000  0.9444  0.9556   
nb                            Naive Bayes    0.9444  1.0000  0.9444  0.9556   
qda       Quadratic Discriminant Analysis    0.9444  0.0000  0.9444  0.9556   
knn                K Neighbors Classifier    0.9188  0.9931  0.9188  0.9350   
ada                  Ada Boost Classifier    0.9188  0.0000  0.9188  0.9350   
gbc          Gradient Boosting Classifier    0.9188  0.0000  0.9188  0.9350   
et                 Extra Trees Classifier    0.9188  1.0000  0.9188  0.9350   
dt               Decision Tree Classifier    0.8932  0.9213  0.8932  0.9214   
rf               Random Forest Classifier    0.8932  0.9965  0.8932  0.9214   
svm                   SVM - Linear Kernel    0.7585  0.0000  0.7585  0.6330   
ridge                    Ridge Classifier    0.6752  0.0000  0.6752  0.6160   
lightgbm  Light Gradient Boosting Machine    0.3248  0.5000  0.3248  0.1056   
dummy                    Dummy Classifier    0.3248  0.5000  0.3248  0.1056   

              F1   Kappa     MCC  TT (Sec)  
lda       1.0000  1.0000  1.0000    0.0167  
lr        0.9436  0.9167  0.9228    2.3300  
nb        0.9436  0.9167  0.9228    0.0200  
qda       0.9436  0.9167  0.9228    0.0167  
knn       0.9179  0.8783  0.8871    1.9500  
ada       0.9179  0.8783  0.8871    0.0467  
gbc       0.9179  0.8783  0.8871    0.0933  
et        0.9179  0.8783  0.8871    0.1000  
dt        0.8910  0.8406  0.8562    0.0200  
rf        0.8910  0.8406  0.8562    0.2133  
svm       0.6770  0.6312  0.6951    5.3400  
ridge     0.6222  0.5091  0.5609    0.0400  
lightgbm  0.1594  0.0000  0.0000    0.2833  
dummy     0.1594  0.0000  0.0000    0.0133  
[2026-01-15T18:20:51.738+0000] {logging_mixin.py:188} WARNING - Registered model 'iris_classifier' already exists. Creating a new version of this model...
[2026-01-15T18:20:52.052+0000] {logging_mixin.py:188} WARNING - 2026/01/15 18:20:52 INFO mlflow.store.model_registry.abstract_store: Waiting up to 300 seconds for model version to finish creation. Model name: iris_classifier, version 8
[2026-01-15T18:20:52.052+0000] {logging_mixin.py:188} WARNING - Created version '8' of model 'iris_classifier'.
[2026-01-15T18:20:52.380+0000] {python.py:202} INFO - Done. Returned value was: {'train': {'export_run_id': '167352bac2e645d9b6fa533be169f8c6', 'train_acc_quick': 0.9811320754716981}, 'registry': {'model_name': 'iris_classifier', 'version': 8, 'stage': 'Staging'}, 'drift': {'drift_detected': True, 'drift_score': 0.6657836894355122, 'report': {'psi_per_feature': {'sepal_length': 0.15730568194638933, 'sepal_width': 0.18138592907280046, 'petal_length': 0.2682708661011944, 'petal_width': 0.6657836894355122}, 'psi_max': 0.6657836894355122, 'psi_mean': 0.3181865416389741}, 'baseline': '/opt/airflow/data/baseline.csv', 'current': '/opt/airflow/data/current.csv', 'shift': 0.05}}
[2026-01-15T18:20:52.406+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=ml_process_from_drift_to_ab, task_id=retrain_and_register, execution_date=20260115T181835, start_date=20260115T181909, end_date=20260115T182052
[2026-01-15T18:20:52.484+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2026-01-15T18:20:52.501+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
